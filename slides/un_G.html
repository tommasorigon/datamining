<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tommaso Rigon">

<title>Frequently Asked Questions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="un_G_files/libs/clipboard/clipboard.min.js"></script>
<script src="un_G_files/libs/quarto-html/quarto.js"></script>
<script src="un_G_files/libs/quarto-html/popper.min.js"></script>
<script src="un_G_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="un_G_files/libs/quarto-html/anchor.min.js"></script>
<link href="un_G_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="un_G_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="un_G_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="un_G_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="un_G_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#homepage" id="toc-homepage" class="nav-link active" data-scroll-target="#homepage">Homepage</a></li>
  <li><a href="#the-modeling-process" id="toc-the-modeling-process" class="nav-link" data-scroll-target="#the-modeling-process">The modeling process</a></li>
  <li><a href="#handling-categorical-variables" id="toc-handling-categorical-variables" class="nav-link" data-scroll-target="#handling-categorical-variables">Handling categorical variables</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="un_F_slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Frequently Asked Questions</h1>
<p class="subtitle lead">Data Mining - CdL CLAMSES</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><span class="orange">Tommaso Rigon</span> </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <em>Università degli Studi di Milano-Bicocca</em>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  

</header>

<section id="homepage" class="level2">
<h2 class="anchored" data-anchor-id="homepage"><a href="../index.html">Homepage</a></h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/russell.jpg" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
<div style="font-size: 80%;">
<p>“<em>The whole problem with the world is that fools and fanatics are always so certain of themselves, and wiser people so full of doubts.</em>”</p>
<p><span class="grey">Bertrand Russell</span></p>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>This is not a normal unit and has a more dynamic nature.</p></li>
<li><p>I will collect here <span class="blue">interesting</span> questions made by students over the years.</p></li>
<li><p>The questions are organized by topic, but some overlap will occur.</p></li>
<li><p>Hopefully, this unit will form the basis of a <span class="orange">statistical culture</span>.</p></li>
<li><p>Indeed, it is based on the knowledge of several statisticians.</p></li>
</ul>
</div>
</div>
</section>
<section id="the-modeling-process" class="level1">
<h1>The modeling process</h1>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What to do when different estimators lead to dissimilar conclusions?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>Well, it happens all the time in applied statistics. It even occurs in Statistics I!</p></li>
<li><p>For example, you might get slightly different values (or even opposite signs) when looking at the estimated regression coefficients <span class="math inline">\hat{\beta}_\text{ols}</span>, <span class="math inline">\hat{\beta}_\text{pcr}</span>, <span class="math inline">\hat{\beta}_\text{ridge}</span>.</p></li>
<li><p>In linear models, do not assume the OLS estimator is “better” just because it is <span class="blue">unbiased</span>. Biased estimates are helpful if they lead to a (sufficiently high) <span class="orange">reduction of the variance</span>.</p></li>
<li><p>In any event, remember these are, indeed, <span class="orange">estimates</span>! By definition, there will be some variability; therefore, the <span class="blue">discrepancies</span> might be due to random <span class="orange">fluctuations</span>.</p></li>
<li><p>To choose among different estimates, we need a criterion (or a combination of criteria), such as the <span class="blue">predictive performance</span>. However, the out-of-sample error is <span class="orange">not</span> the only relevant aspect!</p></li>
<li><p>There might be other considerations to keep in mind, including the <span class="blue">interpretability</span>, the <span class="orange">robustness</span> of the method, and the <span class="grey">computational complexity</span>.</p></li>
<li><p>Whenever different estimates display some differences, try to see it as an <span class="blue">opportunity</span> to <span class="orange">learn something from the data</span>. What could be the reason for such a discrepancy? What tells us about the data we are analyzing?</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How to interpret a wrong model?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>First of all, by wrong, we mean “<span class="orange">biased</span>.” Therefore, being “wrong” could be an advantage <span class="orange">if</span> the <span class="blue">focus</span> is on <span class="blue">pure predictions</span>.</p></li>
<li><p>We can often say something about the <span class="orange">association</span> between the response variable and the covariates, i.e.&nbsp;we can still try to <span class="blue">interpret</span> the results.</p></li>
<li><p>Finding association is appropriate even in the presence of biased estimates, do not be discouraged by this aspect. However, you must be aware that the fitted model is, at best, an <span class="orange">approximation of reality</span> (especially the biased ones), therefore you need to be <span class="blue">prudent</span> in your conclusions.</p></li>
<li><p>The specific <span class="blue">type of association</span> reflects the <span class="blue">assumptions</span> implied by the chosen model. For example, linear models capture the <span class="orange">linear part</span> of the unknown and possibly more complex relationship <span class="math inline">f(x)</span>, but they cannot capture interactions (unless manually included).</p></li>
<li><p>At the very least, we can often say something about the main factors affecting the predictions.</p></li>
<li><p>Obviously, we must be <span class="orange">very careful</span> before making any <span class="orange">causal statement</span>. Remember that association <span class="math inline">\neq</span> causation even when the model is well-specified.</p></li>
<li><p>Do not forget that the estimated effects should be interpreted as “<em>ceteris paribus</em>”! This means that the association between a variable and the response is often expressed conditionally on the other variables’ effect.</p></li>
</ul>
</div>
</div>
</div>
<!-- ## What is the difference between an algorithm and a model? -->
<!-- ::: columns -->
<!-- ::: {.column width="50%"} -->
<!-- - [Model]{.blue}: a simplified *mathematical* representation of reality. -->
<!-- - [Algorithm]{.blue}: a step-by-step procedure that is useful to obtain the unknown parts of a model. -->
<!-- ::: -->
<!-- ::: {.column width="50%"} -->
<!-- [Example]{.orange}: linear models, neural networks, support vector machine, trees. -->
<!-- [Example]{.orange}: gradient descent, Newton-Raphson, pathwise coordinate descent, LAR. -->
<!-- ::: -->
<!-- ::: -->
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why do we care about simple models?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>Simple models are helpful to <span class="orange">explain</span> reality, not just to make predictions.</p></li>
<li><p>Simple models <span class="math inline">\neq</span> linear models. A tree with a few splits is indeed “simple.” Some might say that parametric models relying on well-chosen assumptions are simple, but it depends.</p></li>
<li><p>Simple models tend to be more <span class="orange">robust</span>, i.e., less affected by contamination and changes in the data generative process.</p></li>
<li><p>Besides, the <span class="blue">understanding</span> gained by fitting simple models is precious for estimating the more complex ones because it guides the next steps.</p></li>
<li><p>The modelling process is <span class="blue">iterative</span> and <span class="orange">not a collection of independent</span> and <span class="orange">separate approaches</span>. You fit a model, check the results, and adjust your strategy.</p></li>
<li><p>Another practical concern is that senior statisticians know hundreds of different techniques. When all these ingredients are combined, they generate thousands, if not millions, of competing estimates. Hence, it becomes impossible to “use them all and pick the best performer.” You need guidance to find the final answer.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What if simple models do not work well?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>…for example, what to do when simple models do not predict well?</p>
<ul>
<li><p>In that case, of course, it is time to move on and try something more sophisticated. This occurs often in practice; not every case study can be solved with simple tools.</p></li>
<li><p>However, you <span class="orange">should not</span> fit a sophisticated model without trying the simple ones first. In other terms, I would fit a <span class="blue">deep neural network</span> only after <span class="orange">everything else has failed</span>, as a last resort.</p></li>
<li><p>The statement “<em>data are complicated, therefore I need a complex model</em>” is probably the result of <span class="orange">hype/over-excitement</span> for the new shiny machine learning tool.</p></li>
<li><p>Especially when data are complex, you should first check whether a simple solution exists. Sometimes this is actually the case, because “simple” models tend to have low variance.</p></li>
<li><p>A skilled statistician is not somebody who runs thousands of sophisticated models seeking for the one with the lowest error (i.e.&nbsp;the <a href="un_intro.html#press-the-button">button pressing culture</a>). A skilled statistician is more like an <span class="blue">artisan</span>, who uses her/his tools <span class="orange">when needed</span> and with <span class="orange">intelligence</span>, obtaining accurate predictions because she/he has a good understanding of the data, not as the result of blind trial and error.</p></li>
<li><p>Finally, even when it turns out that a complex model improves the predictive performance, always ask yourself: <span class="orange">“Is it worth it?”</span> The answer is often <span class="blue">context-dependent</span>.</p></li>
<li><p>Once again, there might be other considerations to keep in mind: <span class="blue">interpretability</span>, <span class="orange">robustness</span>, <span class="grey">computational complexity</span>.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="handling-categorical-variables" class="level1">
<h1>Handling categorical variables</h1>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
I have been told that linear models cannot use categorical variables
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>Let me present you <a href="https://en.wikipedia.org/wiki/Dummy_variable_(statistics)">dummy variables</a>!</p></li>
<li><p>This question was not made during a M.Sc. level course such as Data Mining at CLAMSES (otherwise it would have been a bit depressing), but it happened in <span class="orange">other contexts</span>.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In the test set there are a few values that were not observed in the training, what should I do?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>This often occurs when a categorical variable, say <code>city</code>, takes multiple values, e.g.&nbsp;<code>Milan</code>, <code>Naples</code>, <code>Rome</code>, etc. However, a rare value, such as <code>Isernia</code>, may be present in the training and not in the test.</p></li>
<li><p>The same issue can occur when doing cross-validation, or in the internal split into training / validation / test. You might be tempted to <span class="orange">change the seed</span> until you find a good split which does not display the issue. This practice is <span class="orange">wrong</span>; see below.</p></li>
<li><p>First of all, it might take forever until you find a “good” seed. But then, if you keep sampling new splits until a specific condition is satisfied, you are implicitly <span class="orange">inducing dependence</span> across observations, breaking the main rationale of cross-validation or training/test set.</p></li>
<li><p>It would be even worse to “manually” allocate units into each split, because that would also break the main assumption of cross-validation, i.e.&nbsp;the data should be <span class="blue">independently sampled</span>.</p></li>
<li><p>Fair enough, so what should we do? In general, it <span class="blue">depends</span>. As a general strategy: be <span class="orange">creative</span>, use your <span class="blue">judgment</span>.</p></li>
<li><p>Obviously, an option is to <span class="orange">omit the variable</span>, at the clear cost of a loss of information. However, for example if the variable is <span class="blue">binary</span>, this is typically the only option you have. In this case, though, the discarded information is limited because the variable would be nearly constant.</p></li>
<li><p>Alternatively, you could <span class="blue">merge</span> the <span class="blue">rare values</span> with other categories. However, the aggregation criterion is crucial. You could simply merge rare categories into a residual class called <code>Other</code>. Alternatively, you could use your judgment to make <span class="blue">smarter choices</span> (e.g.&nbsp;merging <code>Isernia</code> with <code>Campobasso</code>, both in Molise).</p></li>
<li><p>Other <span class="orange">details</span>: is it preferable to perform the merging before estimating the model (using all the observations for fitting it), or after the estimation procedure (based on a reduced dataset), when making the predictions? This is just another instance of the <span class="orange">bias-variance trade-off</span>. Hence, there are no general answers.</p></li>
<li><p>The story does not ends here. For instance, taking a <span class="blue">Bayesian approach</span> might be another principled possibility: prior information could be exploited to help the estimation, even in the absence of data points in the training.</p></li>
</ul>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="un_G_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>